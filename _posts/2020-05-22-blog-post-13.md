---
title: "自动微分中的连续性问题"
date: 2020-05-22
permalink: /posts/2020/05/blog-post-13
excerpt: '通过构建sigmoid函数来解决选择语句及分段函数的连续性问题。'
tags:
   - 自动微分 
   - 选择语句 
   - 连续性问题 
   - 人工智能 
---

# 如何解决自动微分中选择语句的连续性求导问题

在理科及工科中，总会遇到数值计算。面对观测方程，进行数据拟合，线性化，或者积分，或者非线性优化与梯度下降算法获得最优解极为常见的问题。这些过程，我们需要
自动微分在非线性优化，扩展卡曼滤波，变分同化，及机器学习中有极大的用途。

## 微分方法

### 通过解析式求导计算

这是最常用，也是最准确的;但是涉及到手动计算，比较复杂与繁重。
比如简单的：

$$sin'(x)|_{x=\theta}=cos(x)|_{x=\theta}.$$

但是在建立数学模型时，由于有多个参数以及用户自定义形式的拟合函数，在实现过程中如果手动计算各个参数的导数，比如球谐函数导数，将是极大地工作量。

### 通过差分计算

$$
\frac{\partial f(x)}{\partial x} \xrightarrow{front}\frac{f(x+\delta h)-f(x)}{\delta h}\\
\frac{\partial f(x)}{\partial x} \xrightarrow{back}\frac{f(x)-f(x-\delta h)}{\delta h}\\
\frac{\partial f(x)}{\partial x} \xrightarrow{mid}\frac{f(x+\frac{\delta h}{2})-f(x-\frac{\delta h}{2})}{\delta h}
$$

差分方法的问题在于步长$\delta h$的选择极为不易。

### 通过链式自动求解计算


但是对于判断函数
```c
double f(double a){
    static double a0=5;
    static double k1=0.3;
    static double k2=0.6;
    return a>a0?k1*(a-a0):k2*(a-a0);
}

```
$$
s(x,u)=\frac{1}{1+e^{-u x}}\\
\lim_{u \rightarrow \infty} f(x,u)=s(x,u)*k1*(x-a0)+(1-s(x,u))*k2*(x-a0)
$$
而$s(x,u)=\frac{1}{1+e^{-u x}}$如下图：

![$S(x,u)$](http://mapoet.github.io/images/c.png "S(x,u)")